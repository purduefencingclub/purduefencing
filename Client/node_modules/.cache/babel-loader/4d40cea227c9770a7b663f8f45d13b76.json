{"ast":null,"code":"import _regeneratorRuntime from\"/home/fencingadmin/purduefencing/purduefencing/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fencingadmin/purduefencing/purduefencing/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fencingadmin/purduefencing/purduefencing/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{connect}from\"react-redux\";import{logoutUser}from\"../actions/authActions\";import{Container,Row,Col,Carousel,Button,Form}from\"react-bootstrap\";import Fade from\"react-reveal\";import image1 from\"../image1.jpeg\";import Footer from\"../components/Footer\";import Post from\"../components/DashboardPost\";import Navigation from\"../components/Navigation\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var token;// const [title, setTitle] = useState(\"\");\n// const [body, setBody] = useState(\"\");\nvar Dashboard=function Dashboard(props){try{token=localStorage.getItem(\"jwtToken\").split(\" \")[1];}catch(err){console.log(\"Token doesn't exist!\");}var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];useEffect(function(){var fetchPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"https://157.230.80.32:2718/api/blogs/display\");case 2:res=_context.sent;setPosts(res.data);console.log(res.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchPosts(){return _ref.apply(this,arguments);};}();fetchPosts();});var user=props.auth.user;var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),body=_useState6[0],setBody=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),file=_useState8[0],setFile=_useState8[1];var titleChange=function titleChange(e){setTitle(e.target.value);};var bodyChange=function bodyChange(e){setBody(e.target.value);};var fileChange=function fileChange(e){setFile(e.target.value);};var onLogoutClick=function onLogoutClick(e){e.preventDefault();props.logoutUser();};var handleSubmit=function handleSubmit(e){console.log(file);var formData=new FormData();formData.append(\"title\",title);formData.append(\"body\",body);formData.append(\"image\",file);e.preventDefault();axios.post(\"https://157.230.80.32:2718/api/posts/create\",formData,{headers:{\"x-auth-token\":\"\".concat(token)}}).then(function(res){console.log(res);});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-nav\",children:[/*#__PURE__*/_jsx(Navigation,{}),/*#__PURE__*/_jsx(\"div\",{className:\"header-text\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(\"p\",{className:\"heading-about\",children:[\"WELCOME, \",user.name]})})})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Container,{className:\"fencing-body\",children:[/*#__PURE__*/_jsxs(Container,{className:\"fencing-submit\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fencing-header\",children:\"Submit a new post\"}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Form,{noValidate:true,onSubmit:handleSubmit,className:\"submit-form\",encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Title\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",placeholder:\"Title\",onChange:titleChange})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Body\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:\"Body\",onChange:bodyChange})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formFile\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Upload image\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",onChange:function onChange(e){return setFile(e.target.files[0]);},name:\"image\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"dark\",type:\"submit\",children:\"Submit\"})]})})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Container,{className:\"fencing-submit\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"fencing-header\",children:\"Edit/Delete posts\"}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{xs:1,md:3,children:posts.map(function(p){return/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Post,{post:p})});})})})]}),/*#__PURE__*/_jsx(Button,{variant:\"dark\",type:\"submit\",onClick:onLogoutClick,children:\"Logout\"})]})}),/*#__PURE__*/_jsx(Footer,{})]});};var mapStateToProps=function mapStateToProps(state){return{auth:state.auth};};export default connect(mapStateToProps,{logoutUser:logoutUser})(Dashboard);","map":{"version":3,"sources":["/home/fencingadmin/purduefencing/purduefencing/Client/src/dashboard/Dashboard.js"],"names":["React","useState","useEffect","connect","logoutUser","Container","Row","Col","Carousel","Button","Form","Fade","image1","Footer","Post","Navigation","axios","token","Dashboard","props","localStorage","getItem","split","err","console","log","posts","setPosts","fetchPosts","get","res","data","user","auth","title","setTitle","body","setBody","file","setFile","titleChange","e","target","value","bodyChange","fileChange","onLogoutClick","preventDefault","handleSubmit","formData","FormData","append","post","headers","then","name","files","map","p","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { logoutUser } from \"../actions/authActions\";\nimport { Container, Row, Col, Carousel, Button, Form } from \"react-bootstrap\";\nimport Fade from \"react-reveal\";\nimport image1 from \"../image1.jpeg\";\nimport Footer from \"../components/Footer\";\nimport Post from \"../components/DashboardPost\";\n\nimport Navigation from \"../components/Navigation\";\nimport axios from \"axios\";\nlet token;\n\n// const [title, setTitle] = useState(\"\");\n// const [body, setBody] = useState(\"\");\n\nconst Dashboard = (props) => {\n  try {\n    token = localStorage.getItem(\"jwtToken\").split(\" \")[1];\n  } catch (err) {\n    console.log(\"Token doesn't exist!\");\n  }\n\n  const [posts, setPosts] = useState([]);\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      const res = await axios.get(\"https://157.230.80.32:2718/api/blogs/display\");\n      setPosts(res.data);\n      console.log(res.data);\n    };\n\n    fetchPosts();\n  });\n  const { user } = props.auth;\n  const [title, setTitle] = useState();\n  const [body, setBody] = useState();\n  const [file, setFile] = useState();\n\n  const titleChange = (e) => {\n    setTitle(e.target.value);\n  };\n  const bodyChange = (e) => {\n    setBody(e.target.value);\n  };\n  const fileChange = (e) => {\n    setFile(e.target.value);\n  };\n  Dashboard.propTypes = {\n    logoutUser: PropTypes.func.isRequired,\n    auth: PropTypes.object.isRequired,\n  };\n\n  const onLogoutClick = (e) => {\n    e.preventDefault();\n    props.logoutUser();\n  };\n  const handleSubmit = (e) => {\n    console.log(file);\n    const formData = new FormData();\n    formData.append(\"title\", title);\n    formData.append(\"body\", body);\n    formData.append(\"image\", file);\n\n    e.preventDefault();\n    axios\n      .post(\"https://157.230.80.32:2718/api/posts/create\", formData, {\n        headers: {\n          \"x-auth-token\": `${token}`,\n        },\n      })\n      .then((res) => {\n        console.log(res);\n      });\n  };\n  return (\n    <>\n      <div className=\"dashboard-nav\">\n        <Navigation></Navigation>\n        <div className=\"header-text\">\n          <Container>\n            <Row>\n              <p className=\"heading-about\">WELCOME, {user.name}</p>\n            </Row>\n          </Container>\n        </div>\n      </div>\n      <br />\n      <div>\n        <Container className=\"fencing-body\">\n          <Container className=\"fencing-submit\">\n            <h1 className=\"fencing-header\">Submit a new post</h1>\n            <Row>\n              <Col>\n                <Form\n                  noValidate\n                  onSubmit={handleSubmit}\n                  className=\"submit-form\"\n                  encType=\"multipart/form-data\"\n                >\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Title</Form.Label>\n                    <Form.Control\n                      type=\"email\"\n                      placeholder=\"Title\"\n                      onChange={titleChange}\n                    />\n                  </Form.Group>\n\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Body</Form.Label>\n                    <Form.Control placeholder=\"Body\" onChange={bodyChange} />\n                  </Form.Group>\n                  <Form.Group controlId=\"formFile\" className=\"mb-3\">\n                    <Form.Label>Upload image</Form.Label>\n                    <Form.Control\n                      type=\"file\"\n                      onChange={(e) => setFile(e.target.files[0])}\n                      name=\"image\"\n                    />\n                  </Form.Group>\n                  <Button variant=\"dark\" type=\"submit\">\n                    Submit\n                  </Button>\n                </Form>\n              </Col>\n            </Row>\n          </Container>\n          <br />\n          <br />\n          <hr></hr>\n          <Container className=\"fencing-submit\">\n            <h2 className=\"fencing-header\">Edit/Delete posts</h2>\n            <Container>\n              <Row xs={1} md={3}>\n                {posts.map((p) => (\n                  <Col>\n                    <Post post={p} />\n                  </Col>\n                ))}\n              </Row>\n            </Container>\n          </Container>\n          <Button variant=\"dark\" type=\"submit\" onClick={onLogoutClick}>\n            Logout\n          </Button>\n        </Container>\n      </div>\n      <Footer></Footer>\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  auth: state.auth,\n});\nexport default connect(mapStateToProps, { logoutUser })(Dashboard);\n"]},"metadata":{},"sourceType":"module"}